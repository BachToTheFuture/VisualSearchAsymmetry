# Visual Search Asymmetry: Deep Nets and Humans Share Similar Inherent Biases

This contains all the code required to reproduce the results shown in our paper [[1](#cite_vsa)]. To make things simple we have provided bash scripts that can be used to directly run the specified models to produce the results shown in the paper. If you want to evaluate different parts of the model individually, use the notebook file `runExp.ipynb` inside the `vs_exp/eccNET`directory.

## Environment Preparation

First of all you will need to prepare your environment to run these codes. Make sure you have Ananconda installed on your machine, if you do not have you can follow the instruction from [here](https://docs.anaconda.com/anaconda/install/) to install it. Anaconda will be used to create a virtual environment with all the packages and dependencies which are used in our code.

We have provided a `prepDirectory.sh` bash script for you to quickly prepare your environment. Run the following commands:

```
chmod +x prepDirectory.sh
./prepDirectory.sh
```

The above script will download all the experiment datasets, pre-trained weights, and GBVS models from a dropbox link. The script will automatically place them at the relevant directory location.
Next, the script will create an anaconda environment with all the required packages with the name "vsa_klab".

Once, the directory is prepared activate the conda environment by running `conda activate vsa_klab`.

## Running Visual Search Experiments

**To run the experiment using the *eccNET* model. Run the following command:**

```
chmod +x runExp_eccNET.sh
./runExp_eccNET.sh
```

This will perform all the visual asymmetry search experiments using our proposed eccNET model. It takes 28 mins to run all the experiments on a single NVIDIA GeForce RTX 2080 Ti Rev. A (11GB) GPU. The predicted files will be saved in: `./vs_exp/eccNET/out/eccNET`

**To run the experiment using the ablation model. Run the following command:**

```
chmod +x runExp_ablation.sh
./runExp_ablation.sh
```

This will perform all the visual asymmetry search experiments using all the ablated models in Fig5B in the texts (except the GBVS model which requires you to run in Matlab). It takes 2 hours and 15 mins to run all the experiments on a single NVIDIA GeForce RTX 2080 Ti Rev. A (11GB) GPU. The predicted files will be saved in: `./vs_exp/eccNET/out/MODEL_NAME` for DL based models. For chance, the files will be saved in: `./vs_exp/chance` and pixelMatch will be saved in: `./vs_exp/pixelMatch`. Note model name eccNET_0_0_1 is the model eccNET_18-->17.

**To run the experiments using GBVS:**
Go to the following directory: `vs_exp/gbvs/` and open `visual_search.m` in MATLAB and run. The predictions will be save inside: `vs_exp/gbvs/out_data`. This can take a significant amount of time, the GBVS package does not support GPU. It approximately took ~12 hours for us to run all the experiments on Intel® Core™ i7-8565U CPU with 8 GB of RAM.

## Producing the results and figures from the predictions generated by the models

Note that the repository already contains all the predicted files so that you do not necessarily need to run all the models to generate predictions. Again you can either use the relevant `ipynb` notebook files inside the `vs_exp` directory or simply run the bashscript provided by us to generate all the results and figures.

```
chmod +x generateResults.sh
./generateResults.sh
```

The above code will generate all the figures and plots inside the `vs_exp/results`

## Citations

1. <a name="cite_vsa"></a> Gupta, S.K., Zhang, M., Wu, C., Wolfe, J., & Kreiman, G. (2021). Visual Search Asymmetry: Deep Nets and Humans Share Similar Inherent Biases. [URL][paper]

[//]: #
[paper]: <https://arxiv.org/abs/2106.02953>
